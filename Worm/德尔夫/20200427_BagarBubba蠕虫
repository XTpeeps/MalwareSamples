在可执行程序下写入BagarBubba后缀的蠕虫病毒
分子实验室——www.molecule-labs.com
一、病毒基本信息 
母体文件:
文件名	LogTransport2.exe-.exe_unpack
文件大小	584.00kb
文件类型	exe
壳信息	无壳
文件md5信息	ee2a649967bef77cbf85a0ecbed5b8b9
文件sha1信息	56055dfa124c0df47dbb22ea8e8c02af825eb844
文件sha256信息	0a1c19cf516c84502122b50d2aae0496a3cb15b131bb533e9949f5c18e32d0ef
文件ssdeep信息	12288:4bdfK6xaMVkUet7EwBI+APuAMTi0uhMqe9ts2zWTpMmCG78:4pi6xzVkUetVI5usXJTpMm78

二、病毒概述 
样本为一个蠕虫木马.所属Delf家族,感染特征为电脑下所有exe都会被写入样本本身,并且会有文件原本信息与BagarBubba 串.样本运行时会创建感染文件删除原文件,导致cpu内存被占用
特征:
1.感染文件16进制下被写入蠕虫木马
2.感染文件结尾会被写下BagarBubba
3 感染文件在蠕虫木马段后写下文件所在位置
三、感染情况
获取注册表信息
获取终端服务启用项,版本信息,加载应用初始dll 注册表信息

电脑中exe文件被更改
可以看到蠕虫病毒先是创建了[感染文件].exe- 然后将蠕虫病毒写入exe,在把原文件删除,在把[感染文件].exe-修改为源文件名
感染文件对比
被感染文件与蠕虫病毒对比

未感染与感染文件对比

除去蠕虫代码,源文件与被感染文件不同,被写下了BagarBubba

三、详细分析/功能分析
样本名BagarBubba.exe分析：


	
将原文件读取写入到7z.exe-中


将BagarBubba写入文件,删除原文件

将感染文件.exe-删除

搜索exe,com,sfx,cmd后缀文件

四、总结 
样本为一个蠕虫木马.所属Delf家族,感染特征为电脑下所有exe都会被写入样本本身,并且会有文件原本信息与BagarBubba 串.样本运行时会创建感染文件删除原文件,导致cpu内存被大量占用.将感染文件开头蠕虫部分与结尾BagarBubba 串删除就是原本文件
五、防护措施 
1） 安装杀软软件或服务器安全软件防御蠕虫木马攻击。
2） 不打开来历不明的文档，以及带有图片、文件夹、文档、音视频等图标的文件；
3） 不浏览被安全软件提示为恶意的站点；
4） 不安装来历不明的软件、外挂等，不打开被安全软件标记为恶意的文件；


IOCS列表
文件md5:
ee2a649967bef77cbf85a0ecbed5b8b9
AF632D7B8173D38C364172690C461812
